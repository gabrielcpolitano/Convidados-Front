<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convidados</title>
    
    <!-- Meta tags para compartilhamento no WhatsApp -->
    <meta property="og:title" content="Gabriel & Leliane">
    <meta property="og:description" content="Confirme sua presen√ßa no casamento">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/8B4B8C/FFFFFF?text=Gabriel+%26+Leliane+üíï">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="pt_BR">
    <meta property="og:site_name" content="Casamento Gabriel & Leliane">
    
    <!-- Meta tags adicionais -->
    <meta name="description" content="Lista de presen√ßa para o casamento de Gabriel & Leliane em 01 de Novembro de 2025. Confirme sua presen√ßa!">
    <meta name="keywords" content="casamento, Gabriel, Leliane, lista de presen√ßa, RSVP">
    <meta name="author" content="Gabriel & Leliane">
    
    <!-- Meta tags do Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Gabriel & Leliane - Lista de Presen√ßa">
    <meta name="twitter:description" content="Confirme sua presen√ßa no casamento de Gabriel & Leliane - 01 de Novembro de 2025">
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630/8B4B8C/FFFFFF?text=Gabriel+%26+Leliane+üíï">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíç</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=Dancing+Script:wght@400;500;600;700&family=Libertinus+Serif+Display:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#8B4B8C',
                            light: '#B877B9',
                            dark: '#6B3A6C',
                        },
                        secondary: '#F7E7F8',
                        accent: {
                            DEFAULT: '#D4AF37',
                            light: '#E6C556',
                        }
                    },
                    fontFamily: {
                        'display': ['Playfair Display', 'serif'],
                        'script': ['Dancing Script', 'cursive'],
                        'serif-display': ['Libertinus Serif Display', 'serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease forwards',
                        'slide-up': 'slideUp 0.3s ease',
                        'spin-slow': 'spin 30s linear infinite',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .gradient-bg {
            background: linear-gradient(135deg, #F7E7F8 0%, #E6D7E8 50%, #D4C5E8 100%);
        }
        .card-hover:hover {
            transform: translateY(-8px);
        }
        .btn-shimmer::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .btn-shimmer:hover::before {
            left: 100%;
        }
    </style>
</head>
<body class="font-sans gradient-bg min-h-screen text-slate-800 leading-relaxed">
    <!-- P√°gina Principal -->
    <div id="main-page">
        <div class="max-w-6xl mx-auto p-4 md:p-8">
            <!-- Hero Section -->
            <div class="text-center py-16 md:py-24 bg-gradient-to-br from-purple-50/80 via-pink-50/60 to-yellow-50/40 rounded-3xl mb-16 relative overflow-hidden backdrop-blur-sm shadow-2xl border border-purple-100/50 animate-fade-in">
                <!-- Background Animation -->
                <div class="absolute inset-0 bg-gradient-to-r from-purple-400/10 via-transparent to-yellow-400/10 animate-spin-slow"></div>

                <div class="relative z-10">
                    <h2 class="font-script text-4xl md:text-5xl font-semibold text-primary mb-2">Casamento</h2>
                    <h1 class="font-serif-display text-5xl md:text-8xl font-bold bg-gradient-to-r from-primary via-primary-light to-accent bg-clip-text text-transparent mb-4 leading-tight">
                        Gabriel & Leliane
                    </h1>
                    <div class="relative inline-block">
                        <p class="font-display text-xl md:text-3xl font-semibold text-slate-700 mb-12">01 de Novembro de 2025</p>
                        <span class="absolute -left-8 md:-left-12 top-1/2 transform -translate-y-1/2 text-2xl">‚ú®</span>
                        <span class="absolute -right-8 md:-right-12 top-1/2 transform -translate-y-1/2 text-2xl">‚ú®</span>
                    </div>

                    <!-- Search Section -->
                    <div class="max-w-2xl mx-auto relative">
                        <div class="w-24 h-1 bg-gradient-to-r from-primary to-accent rounded-full mx-auto mb-8 opacity-30"></div>

                        <div class="mb-6">
                            <label class="block text-lg font-medium text-slate-700 mb-4" for="search-input">
                                Buscar seu nome na lista de convidados
                            </label>
                            <div class="relative">
                                <i class="fas fa-search absolute left-5 top-1/2 transform -translate-y-1/2 text-slate-400 text-lg z-10"></i>
                                <input 
                                    type="text" 
                                    id="search-input" 
                                    class="w-full pl-14 pr-6 py-4 border-2 border-purple-100 rounded-xl text-lg bg-white/95 shadow-lg focus:border-primary focus:ring-4 focus:ring-primary/10 focus:outline-none transition-all duration-300 focus:-translate-y-1"
                                    placeholder="Digite seu nome completo..." 
                                    data-testid="input-search"
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search Results -->
            <div id="search-results" class="hidden animate-fade-in">
                <div class="bg-white/95 backdrop-blur-sm rounded-2xl p-8 mb-8 shadow-xl border border-purple-100/50 card-hover transition-all duration-300">
                    <h3 class="text-xl font-semibold mb-6 text-slate-700">Resultados da busca:</h3>
                    <div id="guests-list"></div>
                </div>
            </div>

            <!-- Admin Button -->
            <div class="text-center animate-fade-in">
                <button id="admin-btn" class="inline-flex items-center gap-2 px-4 py-2 text-sm border border-slate-300 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-800 transition-all duration-200" data-testid="button-admin">
                    <i class="fas fa-cog"></i>
                    Acesso Administrativo
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o -->
    <div id="confirm-modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl max-w-md w-11/12 max-h-[80vh] overflow-y-auto shadow-2xl border border-purple-100 animate-slide-up">
            <h2 class="font-display text-2xl font-bold mb-4 text-center text-slate-800">Confirmar Presen√ßa</h2>
            <div class="text-center mb-4">
                <i class="fas fa-heart text-3xl text-primary"></i>
            </div>
            <p class="mb-4 text-center text-slate-700">Ol√°, <span id="guest-name" class="font-semibold text-primary"></span>!</p>
            <p class="mb-8 text-center text-slate-500">Voc√™ confirma sua presen√ßa no casamento de Gabriel & L√©liane em 01/11/2025?</p>

            <div class="flex gap-4 mb-4">
                <button id="confirm-yes" class="flex-1 bg-gradient-to-r from-accent to-accent-light text-white px-6 py-3 rounded-xl font-semibold flex items-center justify-center gap-2 shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 relative overflow-hidden btn-shimmer" data-testid="button-confirm-yes">
                    <i class="fas fa-check"></i>
                    Sim, estarei presente!
                </button>
                <button id="confirm-no" class="flex-1 bg-gradient-to-r from-secondary to-purple-100 text-primary px-6 py-3 rounded-xl font-semibold flex items-center justify-center gap-2 border-2 border-primary hover:bg-primary hover:text-white transition-all duration-300" data-testid="button-confirm-no">
                    <i class="fas fa-times"></i>
                    N√£o poderei ir
                </button>
            </div>

            <button id="close-modal" class="w-full bg-transparent text-slate-600 px-6 py-3 rounded-xl border border-slate-300 hover:bg-slate-50 hover:text-slate-800 transition-all duration-200 flex items-center justify-center gap-2" data-testid="button-close-modal">
                <i class="fas fa-times"></i>
                Cancelar
            </button>
        </div>
    </div>

    <!-- Modal de Login Admin -->
    <div id="login-modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl max-w-md w-11/12 shadow-2xl border border-purple-100 animate-slide-up">
            <div class="text-center mb-4">
                <i class="fas fa-shield-alt text-3xl text-primary"></i>
            </div>
            <h2 class="font-display text-2xl font-bold mb-6 text-center text-slate-800">Login Administrativo</h2>

            <form id="login-form" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2" for="username">
                        <i class="fas fa-user mr-2"></i>
                        Usu√°rio:
                    </label>
                    <input type="text" id="username" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/10 focus:outline-none transition-all duration-300" data-testid="input-username" placeholder="Digite seu usu√°rio">
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2" for="password">
                        <i class="fas fa-lock mr-2"></i>
                        Senha:
                    </label>
                    <input type="password" id="password" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/10 focus:outline-none transition-all duration-300" data-testid="input-password" placeholder="Digite sua senha">
                </div>

                <div class="flex gap-4">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-primary to-primary-light text-white px-6 py-3 rounded-xl font-semibold flex items-center justify-center gap-2 shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 relative overflow-hidden btn-shimmer" data-testid="button-login">
                        <i class="fas fa-sign-in-alt"></i>
                        Entrar
                    </button>
                    <button type="button" id="close-login" class="flex-1 bg-transparent text-slate-600 px-6 py-3 rounded-xl border border-slate-300 hover:bg-slate-50 hover:text-slate-800 transition-all duration-200 flex items-center justify-center gap-2" data-testid="button-close-login">
                        <i class="fas fa-times"></i>
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Painel Administrativo -->
    <div id="admin-page" class="hidden">
        <div class="max-w-7xl mx-auto p-4 md:p-8">
            <!-- Admin Header -->
            <div class="bg-gradient-to-r from-primary to-primary-dark text-white p-8 rounded-2xl mb-12 shadow-xl animate-fade-in">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                    <div>
                        <h1 class="font-display text-2xl md:text-3xl font-bold">Painel Administrativo</h1>
                        <p class="opacity-90">Casamento de Gabriel & L√©liane ‚Äì 01/11/2025</p>
                    </div>
                    <button id="logout-btn" class="self-start md:self-auto bg-white/20 text-white px-6 py-3 rounded-xl hover:bg-white/30 transition-all duration-200 flex items-center gap-2" data-testid="button-logout">
                        <i class="fas fa-sign-out-alt"></i>
                        Sair
                    </button>
                </div>
            </div>

            <!-- Estat√≠sticas -->
            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-12 animate-fade-in">
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-purple-100/50 flex items-center gap-4 card-hover transition-all duration-300 relative overflow-hidden">
                    <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary to-accent"></div>
                    <div class="w-16 h-16 bg-gradient-to-br from-primary to-primary-light rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg">
                        <i class="fas fa-users"></i>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-slate-800" id="total-guests" data-testid="stat-total">0</p>
                        <p class="text-slate-500 text-sm">Total de Convidados</p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-lg border border-purple-100/50 flex items-center gap-4 card-hover transition-all duration-300 relative overflow-hidden">
                    <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-green-500 to-emerald-500"></div>
                    <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-slate-800" id="confirmed-guests" data-testid="stat-confirmed">0</p>
                        <p class="text-slate-500 text-sm">Presen√ßas Confirmadas</p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-lg border border-purple-100/50 flex items-center gap-4 card-hover transition-all duration-300 relative overflow-hidden">
                    <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 to-blue-600"></div>
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg">
                        <i class="fas fa-male"></i>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-slate-800" id="groom-guests" data-testid="stat-groom">0</p>
                        <p class="text-slate-500 text-sm">Lado do Noivo</p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-lg border border-purple-100/50 flex items-center gap-4 card-hover transition-all duration-300 relative overflow-hidden">
                    <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary to-primary-dark"></div>
                    <div class="w-16 h-16 bg-gradient-to-br from-primary to-primary-dark rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg">
                        <i class="fas fa-female"></i>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-slate-800" id="bride-guests" data-testid="stat-bride">0</p>
                        <p class="text-slate-500 text-sm">Lado da Noiva</p>
                    </div>
                </div>
            </div>

            <!-- Filtros e Tabela -->
            <div class="bg-white rounded-2xl shadow-xl border border-purple-100/50 p-8 animate-fade-in">
                <!-- Filtros e Bot√£o Adicionar -->
                <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4 mb-8">
                    <div class="flex flex-wrap gap-2">
                        <button class="px-4 py-2 rounded-lg border border-slate-300 text-slate-600 hover:bg-slate-50 filter-btn active bg-primary text-white" data-filter="all" data-testid="filter-all">
                            <i class="fas fa-list mr-2"></i>
                            Todos
                        </button>
                        <button class="px-4 py-2 rounded-lg border border-slate-300 text-slate-600 hover:bg-slate-50 filter-btn" data-filter="noivo" data-testid="filter-groom">
                            <i class="fas fa-male mr-2"></i>
                            Noivo
                        </button>
                        <button class="px-4 py-2 rounded-lg border border-slate-300 text-slate-600 hover:bg-slate-50 filter-btn" data-filter="noiva" data-testid="filter-bride">
                            <i class="fas fa-female mr-2"></i>
                            Noiva
                        </button>
                        <button class="px-4 py-2 rounded-lg border border-slate-300 text-slate-600 hover:bg-slate-50 filter-btn" data-filter="confirmed" data-testid="filter-confirmed">
                            <i class="fas fa-check-circle mr-2"></i>
                            Confirmados
                        </button>
                    </div>
                    <button id="add-guest-btn" class="bg-gradient-to-r from-primary to-primary-light text-white px-6 py-3 rounded-xl font-semibold flex items-center gap-2 shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 relative overflow-hidden btn-shimmer" data-testid="button-add-guest">
                        <i class="fas fa-plus"></i>
                        Adicionar Convidado
                    </button>
                </div>

                <!-- Tabela de Convidados -->
                <div class="overflow-x-auto rounded-xl border border-slate-200">
                    <table class="w-full bg-white">
                        <thead class="bg-gradient-to-r from-slate-50 to-slate-100">
                            <tr>
                                <th class="text-left p-4 font-bold text-slate-700 text-sm uppercase tracking-wider">
                                    <i class="fas fa-user mr-2"></i>Nome
                                </th>
                                <th class="text-left p-4 font-bold text-slate-700 text-sm uppercase tracking-wider">
                                    <i class="fas fa-heart mr-2"></i>Lado
                                </th>
                                <th class="text-left p-4 font-bold text-slate-700 text-sm uppercase tracking-wider">
                                    <i class="fas fa-check-circle mr-2"></i>Status
                                </th>
                                <th class="text-left p-4 font-bold text-slate-700 text-sm uppercase tracking-wider">
                                    <i class="fas fa-calendar mr-2"></i>Data
                                </th>
                                <th class="text-left p-4 font-bold text-slate-700 text-sm uppercase tracking-wider">
                                    <i class="fas fa-cog mr-2"></i>A√ß√µes
                                </th>
                            </tr>
                        </thead>
                        <tbody id="guests-table" class="divide-y divide-slate-200">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Adicionar Convidado -->
    <div id="add-guest-modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl max-w-md w-11/12 shadow-2xl border border-purple-100 animate-slide-up">
            <div class="text-center mb-4">
                <i class="fas fa-user-plus text-3xl text-primary"></i>
            </div>
            <h2 class="font-display text-2xl font-bold mb-6 text-center text-slate-800">Adicionar Convidado</h2>

            <form id="add-guest-form" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2" for="guest-name-input">
                        <i class="fas fa-user mr-2"></i>
                        Nome Completo:
                    </label>
                    <input type="text" id="guest-name-input" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/10 focus:outline-none transition-all duration-300" required data-testid="input-guest-name" placeholder="Digite o nome completo">
                </div>

                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2" for="guest-side-select">
                        <i class="fas fa-heart mr-2"></i>
                        Lado da Fam√≠lia:
                    </label>
                    <select id="guest-side-select" class="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/10 focus:outline-none transition-all duration-300" required data-testid="select-guest-side">
                        <option value="">Selecione o lado...</option>
                        <option value="noivo">Lado do Noivo</option>
                        <option value="noiva">Lado da Noiva</option>
                    </select>
                </div>

                <div class="flex gap-4">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-primary to-primary-light text-white px-6 py-3 rounded-xl font-semibold flex items-center justify-center gap-2 shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 relative overflow-hidden btn-shimmer" data-testid="button-save-guest">
                        <i class="fas fa-save"></i>
                        Salvar Convidado
                    </button>
                    <button type="button" id="close-add-guest" class="flex-1 bg-transparent text-slate-600 px-6 py-3 rounded-xl border border-slate-300 hover:bg-slate-50 hover:text-slate-800 transition-all duration-200 flex items-center justify-center gap-2" data-testid="button-close-add-guest">
                        <i class="fas fa-times"></i>
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // CONFIGURA√á√ÉO: URL do Backend
        const BACKEND_URL = 'https://convidados-api.onrender.com';

        // Estado global
        let currentGuests = [];
        let filteredGuests = [];
        let currentFilter = 'all';
        let isLoggedIn = false;
        let selectedGuest = null;

        // Fun√ß√µes de API
        async function apiRequest(method, endpoint, data = null) {
            const options = {
                method,
                headers: {
                    'Content-Type': 'application/json',
                },
            };

            if (data) {
                options.body = JSON.stringify(data);
            }

            const url = endpoint.startsWith('http') ? endpoint : `${BACKEND_URL}${endpoint}`;
            const response = await fetch(url, options);
            return response.json();
        }

        // Fun√ß√µes utilit√°rias
        function showElement(id) {
            const element = document.getElementById(id);
            element.classList.remove('hidden');
            element.classList.add('animate-fade-in');
        }

        function hideElement(id) {
            document.getElementById(id).classList.add('hidden');
        }

        function showPage(pageId) {
            document.getElementById('main-page').classList.add('hidden');
            document.getElementById('admin-page').classList.add('hidden');
            const targetPage = document.getElementById(pageId);
            targetPage.classList.remove('hidden');
            targetPage.classList.add('animate-fade-in');
        }

        function updateStats() {
            const total = currentGuests.length;
            const confirmed = currentGuests.filter(g => g.present).length;
            const groom = currentGuests.filter(g => g.side === 'noivo').length;
            const bride = currentGuests.filter(g => g.side === 'noiva').length;

            document.getElementById('total-guests').textContent = total;
            document.getElementById('confirmed-guests').textContent = confirmed;
            document.getElementById('groom-guests').textContent = groom;
            document.getElementById('bride-guests').textContent = bride;
        }

        function applyFilter(filter) {
            currentFilter = filter;

            switch (filter) {
                case 'noivo':
                    filteredGuests = currentGuests.filter(g => g.side === 'noivo');
                    break;
                case 'noiva':
                    filteredGuests = currentGuests.filter(g => g.side === 'noiva');
                    break;
                case 'confirmed':
                    filteredGuests = currentGuests.filter(g => g.present);
                    break;
                default:
                    filteredGuests = [...currentGuests];
            }

            renderGuestsTable();

            // Update filter button styles
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-primary', 'text-white');
                btn.classList.add('text-slate-600', 'hover:bg-slate-50');
                if (btn.dataset.filter === filter) {
                    btn.classList.add('active', 'bg-primary', 'text-white');
                    btn.classList.remove('text-slate-600', 'hover:bg-slate-50');
                }
            });
        }

        function renderGuestsTable() {
            const tbody = document.getElementById('guests-table');
            tbody.innerHTML = '';

            filteredGuests.forEach((guest, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-slate-50 animate-fade-in';
                row.style.animationDelay = `${index * 0.1}s`;
                row.innerHTML = `
                    <td class="p-4">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 bg-gradient-to-br from-primary to-primary-light rounded-full flex items-center justify-center text-white font-bold shadow-md">
                                ${guest.name[0]}
                            </div>
                            <span class="font-semibold text-slate-800">${guest.name}</span>
                        </div>
                    </td>
                    <td class="p-4">
                        <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold ${guest.side === 'noivo' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'}">
                            <i class="fas fa-${guest.side === 'noivo' ? 'male' : 'female'}"></i>
                            ${guest.side === 'noivo' ? 'Noivo' : 'Noiva'}
                        </span>
                    </td>
                    <td class="p-4">
                        <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold ${guest.present ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                            <i class="fas fa-${guest.present ? 'check-circle' : 'clock'}"></i>
                            ${guest.present ? 'Confirmado' : 'Pendente'}
                        </span>
                    </td>
                    <td class="p-4 text-slate-500 text-sm">
                        ${guest.createdAt ? new Date(guest.createdAt).toLocaleDateString('pt-BR') : '-'}
                    </td>
                    <td class="p-4">
                        <div class="flex gap-2">
                            <button 
                                class="p-2 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all duration-200" 
                                onclick="togglePresence(${guest.id}, ${!guest.present})"
                                data-testid="button-toggle-${guest.id}"
                                title="${guest.present ? 'Cancelar presen√ßa' : 'Confirmar presen√ßa'}"
                            >
                                <i class="fas fa-${guest.present ? 'times' : 'check'}-circle"></i>
                            </button>
                            <button 
                                class="p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-all duration-200" 
                                onclick="deleteGuest(${guest.id}, '${guest.name}')"
                                data-testid="button-delete-${guest.id}"
                                title="Remover convidado"
                            >
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function renderSearchResults(guests) {
            const container = document.getElementById('guests-list');
            container.innerHTML = '';

            if (guests.length === 0) {
                container.innerHTML = '<p class="text-slate-500 text-center">Nenhum convidado encontrado com esse nome.</p>';
                return;
            }

            guests.forEach((guest, index) => {
                const guestCard = document.createElement('div');
                guestCard.className = 'bg-white/95 backdrop-blur-sm rounded-2xl p-6 mb-4 shadow-lg border border-purple-100/50 card-hover transition-all duration-300 animate-fade-in';
                guestCard.style.animationDelay = `${index * 0.1}s`;
                guestCard.innerHTML = `
                    <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-primary to-primary-light rounded-full flex items-center justify-center text-white font-bold shadow-md">
                                ${guest.name[0]}
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg text-slate-800">${guest.name}</h3>
                                <p class="text-slate-500">${guest.side === 'noivo' ? 'Lado do Noivo' : 'Lado da Noiva'}</p>
                                <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mt-2 ${guest.present ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                                    <i class="fas fa-${guest.present ? 'check-circle' : 'clock'}"></i>
                                    ${guest.present ? 'Presen√ßa Confirmada' : 'Aguardando Confirma√ß√£o'}
                                </span>
                            </div>
                        </div>
                        <button 
                            class="px-6 py-3 rounded-xl font-semibold flex items-center gap-2 shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 ${guest.present ? 'bg-gradient-to-r from-secondary to-purple-100 text-primary border-2 border-primary hover:bg-primary hover:text-white' : 'bg-gradient-to-r from-accent to-accent-light text-white'}" 
                            onclick="selectGuest(${guest.id}, '${guest.name}', ${guest.present})"
                            data-testid="button-select-${guest.id}"
                        >
                            <i class="fas fa-${guest.present ? 'edit' : 'check'}"></i>
                            ${guest.present ? 'Alterar' : 'Confirmar'}
                        </button>
                    </div>
                `;
                container.appendChild(guestCard);
            });
        }

        // Fun√ß√µes principais
        async function searchGuests() {
            const query = document.getElementById('search-input').value.trim();

            if (query.length < 2) {
                hideElement('search-results');
                return;
            }

            try {
                const guests = await apiRequest('GET', `/api/guests?search=${encodeURIComponent(query)}`);
                renderSearchResults(guests);
                showElement('search-results');
            } catch (error) {
                console.error('Erro ao buscar convidados:', error);
            }
        }

        function selectGuest(id, name, currentPresent) {
            selectedGuest = { id, name, present: currentPresent };
            document.getElementById('guest-name').textContent = name;
            showElement('confirm-modal');
        }

        async function confirmPresence(present) {
            if (!selectedGuest) return;

            try {
                await apiRequest('POST', `/api/guests/${selectedGuest.id}/presence`, { present });
                hideElement('confirm-modal');

                // Refresh search results
                const query = document.getElementById('search-input').value.trim();
                if (query.length >= 2) {
                    searchGuests();
                }

                alert(present ? 'üéâ Presen√ßa confirmada com sucesso!' : 'Presen√ßa cancelada.');
            } catch (error) {
                console.error('Erro ao confirmar presen√ßa:', error);
                alert('Erro ao confirmar presen√ßa. Tente novamente.');
            }
        }

        async function login(username, password) {
            try {
                const result = await apiRequest('POST', '/api/login', { username, password });

                if (result.success) {
                    isLoggedIn = true;
                    hideElement('login-modal');
                    showPage('admin-page');
                    await loadGuests();
                } else {
                    alert('Credenciais inv√°lidas');
                }
            } catch (error) {
                console.error('Erro no login:', error);
                alert('Erro no login. Tente novamente.');
            }
        }

        async function loadGuests() {
            try {
                currentGuests = await apiRequest('GET', '/api/guests');
                currentGuests.sort((a, b) => a.name.localeCompare(b.name));
                updateStats();
                applyFilter(currentFilter);
            } catch (error) {
                console.error('Erro ao carregar convidados:', error);
            }
        }

        async function togglePresence(id, present) {
            try {
                await apiRequest('POST', `/api/guests/${id}/presence`, { present });
                await loadGuests();
            } catch (error) {
                console.error('Erro ao alterar presen√ßa:', error);
                alert('Erro ao alterar presen√ßa. Tente novamente.');
            }
        }

        async function deleteGuest(id, name) {
            if (!confirm(`Tem certeza que deseja remover ${name} da lista de convidados?`)) {
                return;
            }

            try {
                await apiRequest('DELETE', `/api/guests/${id}`);
                await loadGuests();
            } catch (error) {
                console.error('Erro ao remover convidado:', error);
                alert('Erro ao remover convidado. Tente novamente.');
            }
        }

        async function addGuest(name, side) {
            try {
                await apiRequest('POST', '/api/guests', { name, side, present: false });
                await loadGuests();
                hideElement('add-guest-modal');
                document.getElementById('add-guest-form').reset();
                alert('‚úÖ Convidado adicionado com sucesso!');
            } catch (error) {
                console.error('Erro ao adicionar convidado:', error);
                alert('Erro ao adicionar convidado. Tente novamente.');
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Busca de convidados
            const searchInput = document.getElementById('search-input');
            searchInput.addEventListener('input', searchGuests);

            // Modal de confirma√ß√£o
            document.getElementById('confirm-yes').addEventListener('click', () => confirmPresence(true));
            document.getElementById('confirm-no').addEventListener('click', () => confirmPresence(false));
            document.getElementById('close-modal').addEventListener('click', () => hideElement('confirm-modal'));

            // Modal de login
            document.getElementById('admin-btn').addEventListener('click', () => showElement('login-modal'));
            document.getElementById('close-login').addEventListener('click', () => hideElement('login-modal'));

            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                login(username, password);
            });

            // Logout
            document.getElementById('logout-btn').addEventListener('click', function() {
                isLoggedIn = false;
                showPage('main-page');
                document.getElementById('login-form').reset();
            });

            // Filtros
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    applyFilter(this.dataset.filter);
                });
            });

            // Modal adicionar convidado
            document.getElementById('add-guest-btn').addEventListener('click', () => showElement('add-guest-modal'));
            document.getElementById('close-add-guest').addEventListener('click', () => hideElement('add-guest-modal'));

            document.getElementById('add-guest-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('guest-name-input').value;
                const side = document.getElementById('guest-side-select').value;
                addGuest(name, side);
            });

            // Fechar modais clicando no overlay
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.add('hidden');
                    }
                });
            });
        });
    </script>
</body>
</html>